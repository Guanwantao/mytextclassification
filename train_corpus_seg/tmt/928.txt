一种 SFTP 数据 采集 及 审计 的 方法 及 系统 本发明 提供 了 一种 SFTP 数据 采集 及 审计 方法 ， 所述 方法 包括 ： 步骤 1 ) 采集 SSH 协议 密文 传输 阶段 的 数据包 ， 推导 出 SSH 密钥 协商 后 的 传输 密钥 ； 利用 密钥 将 数据包 中 的 密文 数据 转换成 明文 数据 ； 步骤 2 ) 从 SSH 明文 数据 中 提取 SFTP 数据 ， 并 从 SFTP 数据 中 采集 会话 信息 ； 提取 SFTP 数据 的 关键 操作码 ， 并 采集 传输 文件 信息 ； 将 提取 的 SFTP 关键 操作码 还原 为 关键 操作命令 ， 并 采集 关键 操作命令 信息 ； 步骤 3 ) 对 所有 关键 操作命令 进行 黑名单 匹配 ， 对于 匹配 成功 的 关键 操作命令 ， 构造 禁止 该 关键 操作命令 的 SSH 消息 发送给 客户端 ； 并 将 所有 匹配 不 成功 的 关键 操作命令 对应 的 SSH 明文 数据 进行 封装 和 加密 ， 然后 传输 给 服务端 ； 步骤 4 ) 根据 步骤 2 ) 中 采集 的 所有 信息 生成 SFTP 审计 日志 。 
