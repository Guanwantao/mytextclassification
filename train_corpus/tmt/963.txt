一种基于用户自定义的网络抓包系统 本发明涉及一种基于用户自定义的网络抓包系统，包括网卡系统优化系统、无锁列队系统和制定自定义找条件；所述的网卡系统优化系统为绕过Linux系统自带的协议栈，通过mmap的ring直接把packet从内核传递到用户空间去，采取了基于NAPI的零拷贝设计；所述的无锁列队系统为判断头尾指针是否相等；所述的制定自定义找条件为源目IP、源目端口、协议类型、端口号的各种复杂条件的组合，内部程序在抓包存储的过程中，实时对这些过滤条件进行检查。本发明可以解决万兆流量下使用传统抓包方法抓包掉包率过高的问题，同时自定义抓包过滤算法有效的优化抓包性能，减少抓包文件的大小，提高分析效率。
