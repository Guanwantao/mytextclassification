一种 基于 用户 自定义 的 网络 抓包 系统 本发明 涉及 一种 基于 用户 自定义 的 网络 抓包 系统 ， 包括 网卡 系统优化 系统 、 无锁 列队 系统 和 制定 自定义 找 条件 ； 所述 的 网卡 系统优化 系统 为 绕过 Linux 系统 自带 的 协议 栈 ， 通过 mmap 的 ring 直接 把 packet 从 内核 传递 到 用户 空间 去 ， 采取 了 基于 NAPI 的 零 拷贝 设计 ； 所述 的 无锁 列队 系统 为 判断 头尾 指针 是否 相等 ； 所述 的 制定 自定义 找 条件 为源目 IP 、 源目 端口 、 协议 类型 、 端口号 的 各种 复杂 条件 的 组合 ， 内部 程序 在 抓 包 存储 的 过程 中 ， 实时 对 这些 过滤 条件 进行 检查 。 本发明 可以 解决 万兆 流量 下 使用 传统 抓包 方法 抓包 掉包 率过 高 的 问题 ， 同时 自定义 抓包 过滤 算法 有效 的 优化 抓包 性能 ， 减少 抓包 文件 的 大小 ， 提高 分析 效率 。 
