安全 外壳 SSH2 协议 数据 的 采集 方法 和 装置 本发明 实施 例 涉及 安全 外壳 SSH2 协议 数据 的 采集 方法 和 装置 ， 客户端 设备 与 服务端 设备 之间 建立 了 SSH2 连接 ， 该 方法 包括 ： 获取 客户端 设备 与 服务端 设备 之间 传输 的 SSH2 数据包 ； 将 SSH2 数据包 重组 排列 为 有序 的 网络 数据包 ； 依次 检测 SSH2 数据包 的 类型 ； 若 SSH2 数据包 的 类型 表明 SSH2 数据包 为 SSH2 协议 握手 阶段 的 数据包 ， 则 记录 原 握手 信息 ， 替换 为 新 的 握手 信息 ， 当 握手 信息 充分 时 推导 出 SSH2 密钥 协商 后 的 传输 密钥 ； 若 SSH2 数据包 的 类型 表明 SSH2 数据包 为 SSH2 协议 密文 传输 阶段 的 数据包 ， 则 利用 推导 出 的 传输 密钥 ， 将 密文 数据 转换成 明文 数据 ， 将 明文 数据 作为 采集 成果 输出 。 由 上 可见 ， 本发明 实施 例中 ， 可以 使得 数据 采集器 不易 遭到 针对性 攻击 ， 并且 ， 提高 了 采集 效率 ， 用户 体验 好 。 
